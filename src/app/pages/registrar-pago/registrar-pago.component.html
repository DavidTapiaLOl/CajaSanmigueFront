<div class="container py-5 fade-in" *ngIf="pago">
  
  <div class="row justify-content-center">
    <div class="col-md-6 col-lg-5">
      
      <div class="mb-4 text-center">
        <h3 class="fw-bold text-dark">Registrar Pago</h3>
        <p class="text-muted">Cuota #{{ pago.numeroCuota }} del Préstamo #{{ pago.idPrestamo }}</p>
      </div>

      <div class="card border-0 shadow-lg rounded-4 overflow-hidden">
        
        <div class="card-header border-0 py-3 text-center"
             [ngClass]="{
               'bg-primary bg-opacity-10 text-primary': pago.estado === 'Pendiente',
               'bg-danger bg-opacity-10 text-danger': pago.estado === 'Atrasado' || pago.estado === 'Retrasado',
               'bg-success bg-opacity-10 text-success': pago.estado === 'Pagado'
             }">
          <i class="bi fs-1 mb-2 d-block" 
             [ngClass]="{
               'bi-hourglass-split': pago.estado === 'Pendiente',
               'bi-exclamation-circle-fill': pago.estado === 'Atrasado' || pago.estado === 'Retrasado',
               'bi-check-circle-fill': pago.estado === 'Pagado'
             }"></i>
          <h5 class="fw-bold mb-0 text-uppercase">{{ pago.estado }}</h5>
          <small *ngIf="pago.estado === 'Atrasado'" class="d-block mt-1">¡Esta cuota tiene recargo!</small>
        </div>

        <div class="card-body p-4">
          
          <div class="row text-center mb-4">
            <div class="col-6 border-end">
              <label class="small text-muted fw-bold text-uppercase">Fecha Límite</label>
              <p class="fw-bold text-dark mb-0">{{ pago.fechaProgramada | date:'shortDate' }}</p>
            </div>
            <div class="col-6">
              <label class="small text-muted fw-bold text-uppercase">Monto Esperado</label>
              <p class="fw-bold text-primary fs-5 mb-0">{{ pago.montoProgramado | currency }}</p>
            </div>
          </div>

          <form (ngSubmit)="guardarPago()">
            
            <div class="form-floating mb-4">
              <input type="number" class="form-control form-control-lg fw-bold text-center fs-4" 
                     id="montoInput" placeholder="0.00" 
                     [(ngModel)]="montoIngresado" name="monto" required min="1" step="0.01">
              <label for="montoInput" class="w-100 text-center">Monto a Pagar ($)</label>
            </div>

            <div class="d-grid gap-2">
              <button type="submit" class="btn btn-primary btn-lg shadow-sm fw-bold" 
                      [disabled]="!montoIngresado || montoIngresado <= 0">
                <i class="bi bi-cash-coin me-2"></i> Confirmar Pago
              </button>
              
              <button type="button" class="btn btn-light text-muted" (click)="cancelar()">
                Cancelar
              </button>
            </div>

          </form>

        </div>
      </div>

    </div>
  </div>

</div>

<div *ngIf="loading" class="text-center py-5">
  <div class="spinner-border text-primary" role="status"></div>
  <p class="mt-2 text-muted">Cargando información del pago...</p>
</div>